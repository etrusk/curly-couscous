/**
 * Theme System - Semantic CSS Custom Properties
 *
 * Theming strategy:
 * - Default (no data-theme or data-theme="dark"): Dark mode via color-scheme: dark
 * - data-theme="light": Flips color-scheme to light, light-dark() resolves to light values
 * - data-theme="high-contrast": Full override block with color-scheme: dark
 *
 * light-dark() argument order: light-dark(light-value, dark-value)
 * color-mix() used for derived alpha tokens referencing named base variables
 *
 * Okabe-Ito colorblind-safe palette preserved across all themes:
 * - Friendly: #0072B2 (blue)
 * - Enemy: #E69F00 (orange)
 */

/* ============================================
   UNIFIED THEME (dark default, light via color-scheme)
   ============================================ */

:root {
  color-scheme: dark;

  /* === SURFACES (backgrounds) === */
  --surface-ground: light-dark(#fafafa, #242424); /* page background */
  --surface-primary: light-dark(
    #ffffff,
    #2a2a2a
  ); /* main content areas (panels) */
  --surface-secondary: light-dark(
    #f5f5f5,
    #1e1e1e
  ); /* nested elements (scroll containers) */
  --surface-elevated: #ffffff; /* tooltips, overlays, damage numbers */

  /* === CONTENT (text, icons) === */
  --content-primary: light-dark(
    #333,
    rgba(255, 255, 255, 0.87)
  ); /* main text */
  --content-secondary: light-dark(
    #666,
    rgba(255, 255, 255, 0.6)
  ); /* muted text, placeholders */
  --content-muted: light-dark(
    #999,
    rgba(255, 255, 255, 0.38)
  ); /* disabled, hints */

  /* === BORDERS === */
  --border-default: light-dark(#999, #555); /* panel borders */
  --border-subtle: light-dark(#ddd, #444); /* dividers, internal borders */

  /* === INTERACTIVE === */
  --interactive-hover: light-dark(#e8e8e8, #3a3a3a); /* hover backgrounds */
  --interactive-focus: #0072b2; /* focus ring color (matches friendly) */

  /* === FACTION (Okabe-Ito - preserved across all themes) === */
  --faction-friendly: #0072b2; /* friendly blue */
  --faction-enemy: #e69f00; /* enemy orange */
  --faction-friendly-bg: light-dark(
    #e6f2ff,
    color-mix(in srgb, var(--faction-friendly) 15%, transparent)
  ); /* tinted background */
  --faction-enemy-bg: light-dark(
    #fff4e6,
    color-mix(in srgb, var(--faction-enemy) 15%, transparent)
  ); /* tinted background */
  --faction-friendly-text: light-dark(#004d7a, #4da6ff); /* text on tinted bg */
  --faction-enemy-text: light-dark(#8f5a00, #ffb84d); /* text on tinted bg */

  /* === ACTION (intent line colors) === */
  --action-attack: #d55e00; /* red-orange (Okabe-Ito vermillion) */
  --action-heal: #009e73; /* green (Okabe-Ito bluish green) */
  --action-move: #0072b2; /* blue (Okabe-Ito blue, same as friendly) */

  /* === TOKEN (character icons) === */
  --text-on-faction: #ffffff; /* white text on colored faction backgrounds */
  --accent-primary: light-dark(
    #0072b2,
    #00a8ff
  ); /* selection glow, accent highlights */

  /* === STATUS === */
  --status-success: #009e73; /* victory (green) */
  --status-success-bg: light-dark(
    #e6ffe6,
    color-mix(in srgb, var(--status-success) 15%, transparent)
  );
  --status-success-text: light-dark(#006b4d, #00c48c);

  --status-error: #d55e00; /* defeat (red-orange) */
  --status-error-bg: light-dark(
    #ffe6e6,
    color-mix(in srgb, var(--status-error) 15%, transparent)
  );
  --status-error-text: light-dark(#8f3e00, #ff7f3d);

  --status-warning: #cc9a06; /* unknown (yellow) */
  --status-warning-bg: light-dark(
    #fff3cd,
    color-mix(in srgb, var(--status-warning) 15%, transparent)
  );
  --status-warning-text: light-dark(#664d03, #e6b800);

  --status-neutral: #999; /* draw (gray) */
  --status-neutral-bg: light-dark(
    #f0f0f0,
    color-mix(in srgb, var(--status-neutral) 15%, transparent)
  );
  --status-neutral-text: light-dark(#666, #bbb);

  /* === HEALTH === */
  --health-high: #4caf50; /* > 30% HP (green) */
  --health-low: #f44336; /* <= 30% HP (red) */

  /* === CONTRAST (outlines, accessibility) === */
  --contrast-line: #ffffff; /* intent line outlines */

  /* === TARGETING (movement target lines) === */
  --targeting-line-color: light-dark(
    #666666,
    #888888
  ); /* neutral gray for targeting lines */

  /* === GRID (Battle Viewer) === */
  --grid-bg: light-dark(#f5f5f5, #1e1e1e);
  --grid-border: light-dark(#333, #666);
  --cell-bg: light-dark(#ffffff, #2a2a2a);
  --cell-border: light-dark(#ddd, #444);
  --cell-hover-bg: light-dark(#e8e8e8, #3a3a3a);

  /* === SCROLLBAR === */
  --scrollbar-track: light-dark(#f1f1f1, #2a2a2a);
  --scrollbar-thumb: light-dark(#999, #555);
  --scrollbar-thumb-hover: #666;

  /* === TERMINAL OVERLAY TOKENS (new semantic layer) === */

  /* Surfaces */
  --ground: light-dark(#f0f0f5, #1a1a2e);
  --surface: light-dark(rgba(0, 0, 0, 0.02), rgba(255, 255, 255, 0.03));
  --surface-hover: light-dark(rgba(0, 0, 0, 0.05), rgba(255, 255, 255, 0.06));

  /* Borders & dividers */
  --border: light-dark(rgba(0, 0, 0, 0.12), rgba(255, 255, 255, 0.12));
  /* --border-subtle already defined above */
  --divider: light-dark(rgba(0, 0, 0, 0.06), rgba(255, 255, 255, 0.06));

  /* Text */
  --text-primary: light-dark(#333, rgba(255, 255, 255, 0.87));
  --text-secondary: light-dark(#666, rgba(255, 255, 255, 0.6));
  --text-muted: light-dark(#999, rgba(255, 255, 255, 0.38));
  --text-ghost: light-dark(rgba(0, 0, 0, 0.15), rgba(255, 255, 255, 0.15));

  /* Accent */
  --accent: light-dark(#0072b2, #00a8ff);
  --accent-subtle: light-dark(
    rgba(0, 114, 178, 0.12),
    color-mix(in srgb, var(--accent) 15%, transparent)
  );
  --accent-muted: light-dark(
    rgba(0, 114, 178, 0.06),
    color-mix(in srgb, var(--accent) 8%, transparent)
  );

  /* Status */
  --danger: #d55e00;
  --danger-subtle: light-dark(
    rgba(213, 94, 0, 0.12),
    color-mix(in srgb, var(--danger) 15%, transparent)
  );
  --success: #009e73;

  /* Radii */
  --radius-sm: 2px;
  --radius-md: 4px;
  --radius-lg: 6px;

  /* Typography */
  --font-mono:
    "Fira Code", "Cascadia Code", "JetBrains Mono", ui-monospace, monospace;
}

/* ============================================
   LIGHT THEME
   ============================================ */

:root[data-theme="light"] {
  color-scheme: light;
}

/* ============================================
   HIGH CONTRAST THEME
   ============================================ */

:root[data-theme="high-contrast"] {
  color-scheme: dark;

  /* === SURFACES (backgrounds) === */
  --surface-ground: #000000; /* page background (pure black) */
  --surface-primary: #000000; /* main content areas */
  --surface-secondary: #1a1a1a; /* nested elements */
  --surface-elevated: #ffffff; /* tooltips, overlays */

  /* === CONTENT (text, icons) === */
  --content-primary: #ffffff; /* main text (pure white) */
  --content-secondary: #cccccc; /* muted text */
  --content-muted: #999999; /* disabled, hints */

  /* === BORDERS === */
  --border-default: #ffffff; /* panel borders (pure white for max contrast) */
  --border-subtle: #666666; /* dividers */

  /* === INTERACTIVE === */
  --interactive-hover: #1a1a1a; /* hover backgrounds */
  --interactive-focus: #00a8ff; /* brighter focus ring */

  /* === FACTION (Okabe-Ito - preserved but enhanced for contrast) === */
  /* Base colors slightly brightened for better contrast on black */
  --faction-friendly: #0099ff; /* brighter blue */
  --faction-enemy: #ff9900; /* brighter orange */
  --faction-friendly-bg: color-mix(
    in srgb,
    var(--faction-friendly) 20%,
    transparent
  );
  --faction-enemy-bg: color-mix(in srgb, var(--faction-enemy) 20%, transparent);
  --faction-friendly-text: #66ccff;
  --faction-enemy-text: #ffb84d;

  /* === ACTION (intent line colors - brighter for high contrast) === */
  --action-attack: #ff6633; /* brighter vermillion */
  --action-heal: #00ff88; /* brighter green */
  --action-move: #0099ff; /* brighter blue */

  /* === TOKEN (character icons) === */
  --text-on-faction: #ffffff; /* white text on colored faction backgrounds */
  --accent-primary: #00ff00; /* bright green for maximum visibility */

  /* === STATUS === */
  --status-success: #00ff88;
  --status-success-bg: color-mix(
    in srgb,
    var(--status-success) 20%,
    transparent
  );
  --status-success-text: #00ff88;

  --status-error: #ff6633;
  --status-error-bg: color-mix(in srgb, var(--status-error) 20%, transparent);
  --status-error-text: #ff6633;

  --status-warning: #ffcc00;
  --status-warning-bg: color-mix(
    in srgb,
    var(--status-warning) 20%,
    transparent
  );
  --status-warning-text: #ffcc00;

  --status-neutral: #cccccc;
  --status-neutral-bg: color-mix(
    in srgb,
    var(--status-neutral) 20%,
    transparent
  );
  --status-neutral-text: #cccccc;

  /* === HEALTH === */
  --health-high: #00ff00; /* brighter green */
  --health-low: #ff0000; /* pure red */

  /* === CONTRAST (outlines, accessibility) === */
  --contrast-line: #ffffff;

  /* === TARGETING (movement target lines) === */
  --targeting-line-color: #aaaaaa; /* lighter for visibility on black */

  /* === GRID (Battle Viewer) === */
  --grid-bg: #000000;
  --grid-border: #ffffff; /* pure white border */
  --cell-bg: #000000;
  --cell-border: #666666;
  --cell-hover-bg: #1a1a1a;

  /* === SCROLLBAR === */
  --scrollbar-track: #000000;
  --scrollbar-thumb: #666666;
  --scrollbar-thumb-hover: #999999;

  /* === TERMINAL OVERLAY TOKENS (new semantic layer) === */

  /* Surfaces */
  --ground: #000000;
  --surface: rgba(255, 255, 255, 0.05);
  --surface-hover: rgba(255, 255, 255, 0.1);

  /* Borders & dividers */
  --border: #ffffff;
  /* --border-subtle already defined above */
  --divider: rgba(255, 255, 255, 0.15);

  /* Text */
  --text-primary: #ffffff;
  --text-secondary: #cccccc;
  --text-muted: #999999;
  --text-ghost: rgba(255, 255, 255, 0.3);

  /* Accent */
  --accent: #00ff00;
  --accent-subtle: color-mix(in srgb, var(--accent) 20%, transparent);
  --accent-muted: color-mix(in srgb, var(--accent) 10%, transparent);

  /* Status */
  --danger: #ff6633;
  --danger-subtle: color-mix(in srgb, var(--danger) 20%, transparent);
  --success: #00ff88;

  /* Radii */
  --radius-sm: 2px;
  --radius-md: 4px;
  --radius-lg: 6px;

  /* Typography */
  --font-mono:
    "Fira Code", "Cascadia Code", "JetBrains Mono", ui-monospace, monospace;
}

/* ============================================
   HIGH CONTRAST MODE (data-high-contrast)
   Can be combined with any theme
   ============================================ */

:root[data-high-contrast="true"] {
  /* Enhance borders for all themes */
  --border-default-width: 3px;
  --border-subtle-width: 2px;
}

:root[data-high-contrast="true"] * {
  /* Ensure all borders are visible */
  border-width: var(--border-default-width, 2px);
}
